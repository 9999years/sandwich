(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{103:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var a=n(0),r=n.n(a);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),u=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=u(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,o=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=u(n),b=a,h=d["".concat(o,".").concat(b)]||d[b]||p[b]||s;return n?r.a.createElement(h,i(i({ref:t},l),{},{components:n})):r.a.createElement(h,i({ref:t},l))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,o=new Array(s);o[0]=b;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var l=2;l<s;l++)o[l]=n[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},104:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(16),r=n(106);function s(){const{siteConfig:{baseUrl:e="/",url:t}={}}=Object(a.default)();return{withBaseUrl:(n,a)=>function(e,t,n,{forcePrependBaseUrl:a=!1,absolute:s=!1}={}){if(!n)return n;if(n.startsWith("#"))return n;if(Object(r.b)(n))return n;if(a)return t+n;const o=n.startsWith(t)?n:t+n.replace(/^\//,"");return s?e+o:o}(t,e,n,a)}}function o(e,t={}){const{withBaseUrl:n}=s();return n(e,t)}},106:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!a(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},70:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return i})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return u}));var a=n(3),r=(n(0),n(103)),s=n(104);const o={id:"intro",title:"Welcome to Sandwich",sidebar_label:"Introduction",slug:"/"},i={unversionedId:"intro",id:"intro",isDocsHomePage:!1,title:"Welcome to Sandwich",description:"Sandwich is a test framework for Haskell, inspired by and (almost) a drop-in replacement for Hspec. This section will show some of its features.",source:"@site/docs/intro.md",slug:"/",permalink:"/sandwich/docs/",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/intro.md",version:"current",sidebar_label:"Introduction",sidebar:"docs",next:{title:"Contexts",permalink:"/sandwich/docs/contexts"}},c=[{value:"Basic tests",id:"basic-tests",children:[]},{value:"Expectations",id:"expectations",children:[]},{value:"TUI interface",id:"tui-interface",children:[]},{value:"On-disk results",id:"on-disk-results",children:[]}],l={toc:c};function u({components:e,...t}){return Object(r.b)("wrapper",Object(a.a)({},l,t,{components:e,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Sandwich is a test framework for Haskell, inspired by and (almost) a drop-in replacement for ",Object(r.b)("a",{parentName:"p",href:"http://hspec.github.io/"},"Hspec"),". This section will show some of its features."),Object(r.b)("h2",{id:"basic-tests"},"Basic tests"),Object(r.b)("p",null,"Let's start with a basic test suite and add more features as we go along. As with other test frameworks, tests are structured as a ",Object(r.b)("strong",{parentName:"p"},"tree"),", defined using a simple free monad with nodes like ",Object(r.b)("inlineCode",{parentName:"p"},"describe")," and ",Object(r.b)("inlineCode",{parentName:"p"},"it"),". There are a total of 8 such basic nodes and we'll see others as we go along."),Object(r.b)("p",null,'The meat of the tests occurs in "it" nodes at the leaves of the tree. Every test runs in a special monad called ',Object(r.b)("inlineCode",{parentName:"p"},"ExampleT"),", which is essentially a ",Object(r.b)("inlineCode",{parentName:"p"},"ReaderT context LoggingT"),". The ",Object(r.b)("inlineCode",{parentName:"p"},"LoggingT")," part gives tests the ability to log information, and the ",Object(r.b)("inlineCode",{parentName:"p"},"ReaderT")," gives tests access to ",Object(r.b)("em",{parentName:"p"},"context"),". More on this later. The monad also implements some other useful classes like ",Object(r.b)("inlineCode",{parentName:"p"},"MonadIO"),", so you can run arbitrary IO actions."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-haskell",metastring:'title="https://github.com/codedownio/sandwich/blob/master/sandwich-demos/demos/basic/Main.hs"',title:'"https://github.com/codedownio/sandwich/blob/master/sandwich-demos/demos/basic/Main.hs"'},'module Main where\n\nimport Test.Sandwich\n\nbasic :: TopSpec\nbasic = do\n  describe "Arithmetic" $ do\n    it "adds" $ do\n      (2 + 2) `shouldBe` 4\n      (2 + 3) `shouldBe` 5\n\n    it "subtracts" $ do\n      (3 - 2) `shouldBe` 0\n      warn "This test might not be right..."\n\n  describe "Strings" $\n    it "concatenates" $\n      ("abc" <> "def") `shouldBe` "abcdef"\n\nmain :: IO ()\nmain = runSandwichWithCommandLineArgs defaultOptions basic\n')),Object(r.b)("h2",{id:"expectations"},"Expectations"),Object(r.b)("p",null,"The tests above assert things using expectation functions like ",Object(r.b)("inlineCode",{parentName:"p"},"shouldBe"),". There are a variety of these in ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich-Expectations.html"},"Test.Sandwich.Expectations")," such as ",Object(r.b)("inlineCode",{parentName:"p"},"shouldNotBe"),", ",Object(r.b)("inlineCode",{parentName:"p"},"shouldContain"),", etc., and they are similar to other test frameworks."),Object(r.b)("p",null,"These functions simply throw an exception of type ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich-Misc.html#t:FailureReason"},"FailureReason")," which the Sandwich machinery catches and displays. Don't worry, you can throw other exceptions too. You can even write instances for your ",Object(r.b)("a",{parentName:"p",href:"extensions/advanced#formatting-custom-exceptions"},"custom exception types")," so that they display nicely in Sandwich ",Object(r.b)("a",{parentName:"p",href:"formatters/tui"},"formatters"),"."),Object(r.b)("p",null,"To fail a test with a string message, just call ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich-Expectations.html#v:expectationFailure"},"expectationFailure"),'. You can also mark a test as "pending" by calling the ',Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich-Expectations.html#v:pending"},"pending")," function anywhere in the test, or by changing ",Object(r.b)("inlineCode",{parentName:"p"},"it")," to ",Object(r.b)("inlineCode",{parentName:"p"},"xit"),"."),Object(r.b)("h2",{id:"tui-interface"},"TUI interface"),Object(r.b)("p",null,"Let's run this test from the command line, using the ",Object(r.b)("a",{parentName:"p",href:"/docs/formatters/tui"},"Terminal UI interface"),". This will allow us to move around and examine the tests. In particular, we can examine the failure and log message in the subtraction tests."),Object(r.b)("p",null,"Since we used ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:runSandwichWithCommandLineArgs"},"runSandwichWithCommandLineArgs"),", we can pass flags to control the formatter:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"~/sandwich> stack run basic -- --tui\n")),Object(r.b)("video",{width:"100%",controls:!0,autoplay:"true",muted:"true"},Object(r.b)("source",{src:Object(s.a)("img/basic_tui.webm"),type:"video/webm"}),"Your browser does not support the video tag."),Object(r.b)("h2",{id:"on-disk-results"},"On-disk results"),Object(r.b)("p",null,"Unless configured otherwise, each test tree run produces a ",Object(r.b)("em",{parentName:"p"},"directory tree")," which exactly mirrors the test tree structure. For example, the test tree above would produce a tree like the following."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"<test_root>\n\u251c\u2500 results\n\u2502  \u251c\u2500 Arithmetic\n\u2502  \u2502  \u251c\u2500 adds\n\u2502  \u2502  \u2514\u2500 subtracts\n\u2502  \u2502     \u2514\u2500 test_logs.txt # contains the log warning message\n\u2502  \u2514\u2500 Strings\n\u2502     \u2514\u2500 concatenates\n\u2514\u2500 errors\n   \u2514\u2500 subtracts --\x3e ../results/subtracts # failure symlink\n")),Object(r.b)("p",null,"Thus, every test tree node has a place where it can stash logs, screenshots, or other artifacts. This structure makes it easy to browse through your tests and check results. Also, the ",Object(r.b)("inlineCode",{parentName:"p"},"errors")," folder at the root provides a handy list of symlinks to all failures."),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Check out the next sections to learn about contexts, hooks, and more!")))}u.isMDXComponent=!0}}]);