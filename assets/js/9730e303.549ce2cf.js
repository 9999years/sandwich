(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{102:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(16),r=n(104);function o(){const{siteConfig:{baseUrl:e="/",url:t}={}}=Object(a.default)();return{withBaseUrl:(n,a)=>function(e,t,n,{forcePrependBaseUrl:a=!1,absolute:o=!1}={}){if(!n)return n;if(n.startsWith("#"))return n;if(Object(r.b)(n))return n;if(a)return t+n;const s=n.startsWith(t)?n:t+n.replace(/^\//,"");return o?e+s:s}(t,e,n,a)}}function s(e,t={}){const{withBaseUrl:n}=o();return n(e,t)}},104:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!a(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},85:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return i})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return u}));var a=n(3),r=(n(0),n(99)),o=n(102);const s={id:"sandwich-slack",title:"Slack integration"},i={unversionedId:"extensions/sandwich-slack",id:"extensions/sandwich-slack",isDocsHomePage:!1,title:"Slack integration",description:"The Slack formatter allows you to send live test results to a Slack channel. It shows the overall progress through the tests as a progress bar, and also shows failures as they occur.",source:"@site/docs/extensions/sandwich-slack.md",slug:"/extensions/sandwich-slack",permalink:"/sandwich/docs/extensions/sandwich-slack",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/extensions/sandwich-slack.md",version:"current",sidebar:"docs",previous:{title:"Selenium integration",permalink:"/sandwich/docs/extensions/sandwich-webdriver"},next:{title:"QuickCheck integration",permalink:"/sandwich/docs/extensions/sandwich-quickcheck"}},c=[{value:"Usage",id:"usage",children:[]},{value:"Customizing the message",id:"customizing-the-message",children:[]},{value:"Limiting output",id:"limiting-output",children:[]},{value:"Visibility thresholds",id:"visibility-thresholds",children:[]}],l={toc:c};function u({components:e,...t}){return Object(r.b)("wrapper",Object(a.a)({},l,t,{components:e,mdxType:"MDXLayout"}),Object(r.b)("p",null,"The ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich-slack"},"Slack formatter")," allows you to send live test results to a Slack channel. It shows the overall progress through the tests as a progress bar, and also shows failures as they occur."),Object(r.b)("p",null,"When applied to the arithmetic example from the landing page, it looks like this:"),Object(r.b)("img",{alt:"Simple timing example",src:Object(o.a)("img/slack.gif")}),Object(r.b)("h2",{id:"usage"},"Usage"),Object(r.b)("p",null,"To enable it, add ",Object(r.b)("inlineCode",{parentName:"p"},"sandwich-slack")," to your project and add the formatter to the ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich-Options.html#v:optionsFormatters"},"optionsFormatters")," of your Sandwich options."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-haskell"},'import Test.Sandwich.Formatters.Slack\n\nmain :: IO ()\nmain = runSandwich options myTests\n  where\n    options = defaultOptions {\n      optionsFormatters = [SomeFormatter $ defaultSlackFormatter {\n        slackFormatterSlackConfig = SlackConfig "MY-SLACK-TOKEN"\n        , slackFormatterChannel = "my-channel"\n        }]\n      }\n')),Object(r.b)("p",null,"If you're using ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich/docs/Test-Sandwich.html#v:runSandwichWithCommandLineArgs"},"runSandwichWithCommandLineArgs"),", you can control the Slack formatter settings using command line args. For example, you can pass ",Object(r.b)("inlineCode",{parentName:"p"},"--slack-token $SLACK_TOKEN"),", which makes it easy to inject a token from a secret within your CI system. Pass ",Object(r.b)("inlineCode",{parentName:"p"},"--print-slack-flags")," to see all the command line options."),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Note that you need to set up a Slack token first. Nowadays this is done by creating a ",Object(r.b)("a",{parentName:"p",href:"https://api.slack.com/apps"},"Slack App"),'. Make sure your app has "bot" permissions to interact in channels, and permission to make Slack API requests. To allow your app to send messages to a private channel, you\'ll want to add the app to the channel by typing ',Object(r.b)("inlineCode",{parentName:"p"},"/invite app-name")," in the channel.")),Object(r.b)("h2",{id:"customizing-the-message"},"Customizing the message"),Object(r.b)("p",null,"Several options exist to configure the output."),Object(r.b)("p",null,"First of all, you'll probably want to set  ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich-slack/docs/Test-Sandwich-Formatters-Slack.html#v:slackFormatterTopMessage"},"slackFormatterTopMessage"),", which allows you to control the message that appears above the progress bar. This is a useful place to put the name of the test suite and/or a link to the CI job where it's running."),Object(r.b)("h2",{id:"limiting-output"},"Limiting output"),Object(r.b)("p",null,"Most of the other options have to do with controlling how much information appears in the Slack message. We don't want to show an overwhelming amount of output in Slack if your test suite has a large number of failures, or if some failures produce large amounts of text. You can cap the total number of failures reported and the total number of bytes used in the message sent to the Slack API."),Object(r.b)("p",null,"Each failure reported in the message consists of two parts: the failure reason and the callstack. You can cap the number of lines that will be devoted to each of these."),Object(r.b)("h2",{id:"visibility-thresholds"},"Visibility thresholds"),Object(r.b)("p",null,"One other interesting option is  ",Object(r.b)("a",{parentName:"p",href:"http://hackage.haskell.org/package/sandwich-slack/docs/Test-Sandwich-Formatters-Slack.html#v:slackFormatterVisibilityThreshold"},"slackFormatterVisibilityThreshold"),". This option allows you to set a visibility threshold for which nodes are reported in failures. See the ",Object(r.b)("a",{parentName:"p",href:"../node_options#visibility-thresholds"},"visibility threshold")," docs for more."))}u.isMDXComponent=!0},99:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),u=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},h=function(e){var t=u(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),h=u(n),d=a,m=h["".concat(s,".").concat(d)]||h[d]||p[d]||o;return n?r.a.createElement(m,i(i({ref:t},l),{},{components:n})):r.a.createElement(m,i({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,s[1]=i;for(var l=2;l<o;l++)s[l]=n[l];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);